/* Basic mobile-first styles */
:root {
  --bg:#0f1115; --panel:#1c2128; --panel-alt:#242c35;
  --accent-blue:#5aa9ff; --accent-purple:#b18bff;
  --accent:linear-gradient(90deg,#b18bff,#5aa9ff); /* fallback usage */
  --accent-solid:#7da6ff; /* legacy single color fallback */
  --accent-fade:#4cc2ff33; --danger:#ff4d61; --warn:#ffbf3c;
  --text:#e6eef5; --muted:#93a3b5; --radius:10px; --gap:0.75rem; --focus:#ffe071;
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
}
* { box-sizing: border-box; }
body { margin:0; background:linear-gradient(145deg,#1a1230 0%,#241d48 35%,#0f1f3a 70%,#0a1324 100%); color:var(--text); min-height:100vh; display:flex; flex-direction:column; position:relative; }
body::before { content:""; position:fixed; inset:0; pointer-events:none; background:
  radial-gradient(circle at 18% 22%, rgba(177,139,255,0.28), transparent 55%),
  radial-gradient(circle at 82% 72%, rgba(90,169,255,0.22), transparent 60%),
  radial-gradient(circle at 60% 40%, rgba(110,90,255,0.12), transparent 65%);
  mix-blend-mode:screen; opacity:0.85; z-index:0; }

.app-header { position:sticky; top:0; background:#12181fdd; backdrop-filter:blur(6px); padding:0.75rem var(--gap); z-index:100; box-shadow:0 2px 4px #00000060; }
.app-header h1 { margin:0 0 .5rem; font-size:1.25rem; letter-spacing:0.5px; display:flex; align-items:center; gap:.5rem; }
.birthday-badge { font-size:1.05rem; filter:drop-shadow(0 0 4px #ffde7a90); animation:badge-pop 1.6s ease-in-out infinite alternate; }
@keyframes badge-pop { 0% { transform:scale(1); } 100% { transform:scale(1.13) rotate(3deg); } }
#version { font-size:.75rem; background:var(--panel-alt); padding:2px 6px; border-radius:6px; color:var(--muted); }
.scoreboard { display:flex; gap:1rem; flex-wrap:wrap; align-items:center; font-size:.85rem; }
.player-score { background:var(--panel-alt); padding:.4rem .6rem; border-radius:var(--radius); box-shadow:inset 0 0 0 1px #ffffff10; }
.player-score .score { font-weight:600; background:var(--accent); -webkit-background-clip:text; background-clip:text; color:transparent; }
.bonus-control { background:var(--panel-alt); padding:.4rem .6rem; border-radius:var(--radius); }
.controls-row { display:flex; gap:.5rem; margin-top:.5rem; flex-wrap:wrap; }
button { cursor:pointer; background:var(--panel-alt); color:var(--text); border:1px solid #ffffff12; padding:.55rem .85rem; border-radius:var(--radius); font-size:.8rem; line-height:1; font-weight:500; transition:.15s background,.15s border-color; }
button:hover, button:focus { background:var(--panel); outline:none; }
button.warn { background:#402116; border-color:#ff6d3f55; }
button.warn:hover { background:#592b1c; }
button.filter.active { border-color:var(--accent-purple); box-shadow:0 0 0 1px #b18bff55; }

.challenge-list { padding: var(--gap); display:grid; gap:var(--gap); grid-auto-rows:minmax(0,auto); }
.challenge { background:var(--panel); border:1px solid #ffffff10; border-radius:var(--radius); padding:0.85rem 0.85rem 0.7rem; position:relative; display:flex; flex-direction:column; gap:.6rem; }
.challenge.coop { border-color:#6aa84f55; }
.challenge.skip { opacity:.55; }
.challenge-header { display:flex; flex-direction:column; gap:.35rem; }
.challenge-header-row { display:flex; justify-content:space-between; align-items:flex-start; gap:0.5rem; }
.challenge-title { font-size:1rem; margin:0; line-height:1.2; font-weight:600; }
.badges { display:flex; gap:.4rem; flex-wrap:wrap; }
.badge { font-size:.55rem; text-transform:uppercase; letter-spacing:.5px; background:var(--panel-alt); padding:3px 6px 2px; border-radius:999px; color:var(--muted); border:1px solid #ffffff15; font-weight:600; }
.badge.coop { background:#25401f; color:#b4ddb0; }
.badge.skipped { background:#402b1f; color:#ffbf8d; }
.badge.done { background:#1f3d54; color:#9cd7ff; }

/* Location pill */
.location-pill { display:inline-flex; align-items:center; gap:4px; font-size:.55rem; padding:3px 7px 3px 6px; border-radius:999px; background:linear-gradient(135deg,var(--accent-purple),var(--accent-blue)); color:#08121a; font-weight:600; text-decoration:none; box-shadow:0 0 0 1px #00000055, 0 1px 2px #0006; border:1px solid #ffffff30; }
.location-pill:hover, .location-pill:focus { filter:brightness(1.08); outline:2px solid #ffffff22; outline-offset:2px; }
.location-pill:active { transform:translateY(1px); }

.targets { display:grid; gap:.45rem; }
.target { display:flex; align-items:flex-start; gap:.55rem; background:var(--panel-alt); padding:.55rem .6rem; border-radius:8px; position:relative; border:1px solid #ffffff08; }
.target button.toggle { flex-shrink:0; width:28px; height:28px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:.75rem; font-weight:600; border:1px solid #ffffff12; background:#19242e; color:var(--muted); }
.target button.toggle.done { background:linear-gradient(135deg,var(--accent-purple),var(--accent-blue)); color:#08121a; box-shadow:0 0 0 2px #00000040 inset; }
.target .text { font-size:.7rem; line-height:1.25; }
.target .text .players { margin-top:4px; display:flex; gap:4px; flex-wrap:wrap; }
.player-chip { font-size:.55rem; padding:2px 5px; border-radius:5px; background:#26323d; color:var(--muted); border:1px solid #ffffff10; cursor:pointer; }
.player-chip.active { background:linear-gradient(135deg,var(--accent-purple),var(--accent-blue)); color:#08121a; }

/* Target label (clickable for details) */
.target-label { font-weight:500; cursor:pointer; text-decoration:underline dotted #ffffff33; text-underline-offset:3px; }
.target-label:focus { outline:2px solid var(--focus); outline-offset:2px; }

/* Detail modal */
.detail-overlay { position:fixed; inset:0; background:#000a; backdrop-filter:blur(4px); display:flex; align-items:center; justify-content:center; padding:1.5rem; z-index:400; }
.detail-dialog { background:var(--panel); max-width:420px; width:100%; border:1px solid #ffffff22; border-radius:14px; padding:1.1rem 1.2rem 1.25rem; box-shadow:0 6px 28px -4px #000c; animation:pop .26s cubic-bezier(.25,.9,.35,1.2); }
.detail-dialog h3 { margin:.2rem 0 .4rem; font-size:.9rem; line-height:1.1; }
.detail-dialog h4 { margin:.2rem 0 .6rem; font-size:.8rem; background:var(--accent); -webkit-background-clip:text; background-clip:text; color:transparent; letter-spacing:.3px; }
.detail-dialog p { font-size:.7rem; line-height:1.3; margin:.4rem 0; }
.detail-dialog .hint { opacity:.55; font-style:italic; }
.challenge-long { background:#202536; padding:.55rem .65rem; border:1px solid #ffffff12; border-radius:10px; font-size:.65rem; line-height:1.3; }
.challenge-note { background:#262035; padding:.45rem .6rem; border:1px solid #ffffff12; border-radius:8px; font-size:.6rem; line-height:1.25; margin-top:.6rem; }
.bonus-block { background:#1d2f3b; padding:.5rem .6rem; border:1px dashed #5aa9ff66; border-radius:9px; font-size:.6rem; line-height:1.25; margin-top:.6rem; position:relative; }
.bonus-block strong { color:var(--accent-blue); }
.bonus-block .sc-tag { font-size:.55rem; background:#15232c; padding:2px 6px; border-radius:999px; border:1px solid #5aa9ff33; margin-left:.35rem; color:#8abff8; }
.detail-dialog .loc-block { background:#202832; padding:.55rem .65rem .6rem; border:1px solid #ffffff15; border-radius:10px; margin:.4rem 0 .7rem; font-size:.62rem; line-height:1.25; display:flex; flex-direction:column; gap:.25rem; }
.detail-dialog .loc-block a { color:var(--accent-blue); text-decoration:none; }
.detail-dialog .loc-block a:hover { text-decoration:underline; }
.detail-dialog .loc-address { opacity:.75; }
.detail-dialog .loc-suggested { font-style:italic; opacity:.85; }
.detail-dialog .loc-backups summary { cursor:pointer; font-weight:600; margin-bottom:.25rem; }
.detail-dialog .loc-backups ul { list-style:disc; padding-left:1.1rem; margin:.2rem 0 0; display:flex; flex-direction:column; gap:.2rem; }
.detail-dialog .loc-backups li { margin:0; }
.detail-dialog .loc-backups .note { opacity:.7; }
.close-detail { position:absolute; top:8px; right:10px; background:#222e38; border:1px solid #ffffff18; font-size:.85rem; padding:4px 8px; line-height:1; border-radius:6px; cursor:pointer; }
.close-detail:hover { background:#2a3743; }
@keyframes pop { 0% { transform:translateY(6px) scale(.96); opacity:0; } 100% { transform:translateY(0) scale(1); opacity:1; } }

/* Confetti particles */
.confetti { position:fixed; top:0; left:0; width:100%; height:0; pointer-events:none; overflow:visible; z-index:500; }
.confetti i { position:absolute; width:10px; height:14px; background:linear-gradient(180deg,var(--accent-purple),var(--accent-blue)); top:-20px; opacity:0.95; border-radius:2px; animation:fall linear forwards; }
@keyframes fall { to { transform:translateY(110vh) rotate(720deg); opacity:1; } }
/* Color variants injected via style attr JS */

.challenge-footer { display:flex; justify-content:space-between; align-items:center; gap:.5rem; flex-wrap:wrap; }
.footer-buttons { display:flex; gap:.4rem; }
.footer-buttons button { font-size:.65rem; padding:.45rem .6rem; }
.progress-bar-wrap { flex:1; background:#222d36; height:6px; border-radius:4px; overflow:hidden; position:relative; }
.progress-bar { position:absolute; top:0; left:0; height:100%; width:0%; background:linear-gradient(90deg,var(--accent-purple),var(--accent-blue)); transition:width .25s; }

.collapse-toggle { position:absolute; top:6px; right:6px; background:#202830; border:1px solid #ffffff10; color:var(--muted); font-size:.6rem; padding:3px 6px; border-radius:6px; }
.collapse-toggle:hover { background:#28323d; }
.challenge.collapsed .targets { display:none; }
.challenge.collapsed .collapse-toggle::after { content:" (show)"; }

.app-footer { margin-top:auto; padding:1rem var(--gap); text-align:center; font-size:.6rem; color:var(--muted); opacity:.8; }

@media (min-width:700px) {
  .challenge-list { grid-template-columns:repeat(auto-fill,minmax(330px,1fr)); }
  .app-header h1 { font-size:1.35rem; }
}
